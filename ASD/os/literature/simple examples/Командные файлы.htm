
<!-- saved from url=(0032)http://white55.narod.ru/cmd.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><script type="text/javascript">var y5_pageId = 77160; var y5_statId = 0; document.write('<sc' + 'ript type="text/javascript" src="http://bs.yandex.ru/resource/narod_init.js?rnd=' + Math.round(Math.random() * 100000) + '"></sc' + 'ript>');</script><script type="text/javascript" src="./Командные файлы_files/narod_init.js"></script><script type="text/javascript" src="./Командные файлы_files/narod_static_1x3.js"></script>
<script src="./Командные файлы_files/77160" type="text/javascript" charset="windows-1251"></script><style type="text/css">#y5937935-banner {font-size: 11px !important; position: relative !important; z-index: 999 !important;} #y5937935-banner * {background: none !important; border: 0 !important; clip: auto !important; clear: both !important; color: #000 !important; cursor: auto !important; float: none !important; font-family: Verdana, Arial, sans-serif !important; font-size: 100% !important; font-style: normal !important; font-variant: normal !important; font-weight: normal !important; line-height: 120% !important; margin: 0 !important; overflow: visible !important; padding: 0 !important; position: static !important; text-decoration: none !important; text-indent: 0 !important; text-transform: none !important; visibility: visible !important; white-space: normal !important; word-spacing: normal !important;} #y5937935-banner a {cursor: pointer !important; cursor: hand !important; text-decoration: underline !important;} #y5937935-banner a * {cursor: pointer !important; cursor: hand !important; text-decoration: underline !important;} #y5937935-banner table {border-collapse: collapse !important;} #y5937935-banner td {color: #000 !important; font-size: 11px !important; padding: 0 !important; text-align: left !important; vertical-align: top !important;}#y5937935-banner .header {width: 100% !important;} #y5937935-banner .header td {width: 50% !important; padding: 0.25em 1em !important;} #y5937935-banner .header td.right {text-align: right !important;} #y5937935-banner .header td div {display: inline !important; height: 0 !important;} #y5937935-banner .header td div * {white-space: nowrap !important;} #y5937935-banner .header td div.direct {margin-right: 1em !important;} #y5937935-banner .header td div.close {margin-left: 1em !important;} #y5937935-banner .header td div.close * {cursor: pointer !important; cursor: hand !important;} #y5937935-banner .header td div.close span.text {text-decoration: underline !important;} #y5937935-banner .data {width: 100% !important;} #y5937935-banner .data td.block {padding: 0.5em !important;} #y5937935-banner .data td.block div.ad-link {font-size: 110% !important; margin-bottom: 0.1em !important;} #y5937935-banner .data td.block span.url {display: block !important;}#y5937935-banner .header {background: #feeac7 !important;} #y5937935-banner .header a {color: #000 !important;} #y5937935-banner .data {background: #fff9f0 !important; border: 1px solid #fbe5c0 !important;} #y5937935-banner .data td.block div.ad-link a {color: #00c !important; font-weight: bold !important;} #y5937935-banner .data td.block span.url {color: #060 !important;} #y5937935-banner .data td.block span.url a {color: #060 !important;}#y5937935-banner .data td.block span.url a {background: url("http://img.yandex.net/i/ico-phone.gif") no-repeat 0 50% !important; padding-left: 16px !important;} * html #y5937935-banner .data td.block span.url a {height: 0 !important; margin-bottom: -0.2em !important;}</style><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/document_iterator.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/find_proxy.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/get_html_text.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/global_constants.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/name_injection_builder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/number_injection_builder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/menu_injection_builder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/string_finder.js"></script><script src="chrome-extension://lifbcibllhkdhoafpjfnlhfpfgnpldfl/change_sink.js"></script><meta name="document_iterator.js"><meta name="find_proxy.js"><meta name="get_html_text.js"><meta name="global_constants.js"><meta name="name_injection_builder.js"><meta name="number_injection_builder.js"><meta name="string_finder.js"><meta name="menu_injection_builder.js"><meta name="change_sink.js"><style id="wrc-middle-css" type="text/css">.wrc_whole_window{	display: none;	position: fixed; 	z-index: 2147483647;	background-color: rgba(40, 40, 40, 0.9);	word-spacing: normal !important;	margin: 0px !important;	padding: 0px !important;	border: 0px !important;	left: 0px;	top: 0px;	width: 100%;	height: 100%;	line-height: normal !important;	letter-spacing: normal !important;	overflow: hidden;}.wrc_bar_window{	display: none;	position: fixed; 	z-index: 2147483647;	background-color: rgba(60, 60, 60, 1.0);	word-spacing: normal !important;	font-family: Segoe UI, Arial Unicode MS, Arial, Sans-Serif;	margin: 0px !important;	padding: 0px !important;	border: 0px !important;	left: 0px;	top: 0px;	width: 100%;	height: 40px;	line-height: normal !important;	letter-spacing: normal !important;	color: white !important;	font-size: 13px !important;}.wrc_middle {	display: table-cell;	vertical-align: middle;	width: 100%;}.wrc_middle_main {	font-family: Segoe UI, Arial Unicode MS, Arial, Sans-Serif;	font-size: 14px;	width: 600px;	height: auto;    background: url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/background-body.jpg) repeat-x left top;	background-color: rgb(39, 53, 62);	position: relative;	margin-left: auto;	margin-right: auto;	text-align: left;}.wrc_middle_tq_main {	font-family: Segoe UI, Arial Unicode MS, Arial, Sans-Serif;	font-size: 16px;	width: 615px;	height: 460px;    background: url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/background-sitecorrect.png) no-repeat;	background-color: white;	color: black !important;	position: relative;	margin-left: auto;	margin-right: auto;	text-align: center;}.wrc_middle_logo {    background: url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/logo.jpg) no-repeat left bottom;    width: 140px;    height: 42px;    color: orange;    display: table-cell;    text-align: right;    vertical-align: middle;}.wrc_icon_warning {	margin: 20px 10px 20px 15px;	float: left;	background-color: transparent;}.wrc_middle_title {    color: #b6bec7;	height: auto;    margin: 0px auto;	font-size: 2.2em;	white-space: nowrap;	text-align: center;}.wrc_middle_hline {    height: 2px;	width: 100%;    display: block;}.wrc_middle_description {	text-align: center;	margin: 15px;	font-size: 1.4em;	padding: 20px;	height: auto;	color: white;	min-height: 3.5em;}.wrc_middle_actions_main_div {	margin-bottom: 15px;	text-align: center;}.wrc_middle_actions_blue_button div {	display: inline-block;	width: auto;	cursor: Pointer;	margin: 3px 10px 3px 10px;	color: white;	font-size: 1.2em;	font-weight: bold;}.wrc_middle_actions_blue_button {	-moz-appearance: none;	border-radius: 7px;	-moz-border-radius: 7px/7px;	border-radius: 7px/7px;	background-color: rgb(0, 173, 223) !important;	display: inline-block;	width: auto;	cursor: Pointer;	border: 2px solid #00dddd;	padding: 0px 20px 0px 20px;}.wrc_middle_actions_blue_button:hover {	background-color: rgb(0, 159, 212) !important;}.wrc_middle_actions_blue_button:active {	background-color: rgb(0, 146, 200) !important;	border: 2px solid #00aaaa;}.wrc_middle_actions_grey_button div {	display: inline-block;	width: auto;	cursor: Pointer;	margin: 3px 10px 3px 10px;	color: white !important;	font-size: 15px;	font-weight: bold;}.wrc_middle_actions_grey_button {	-moz-appearance: none;	border-radius: 7px;	-moz-border-radius: 7px/7px;	border-radius: 7px/7px;	background-color: rgb(100, 100, 100) !important;	display: inline-block;	width: auto;	cursor: Pointer;	border: 2px solid #aaaaaa;	text-decoration: none;	padding: 0px 20px 0px 20px;}.wrc_middle_actions_grey_button:hover {	background-color: rgb(120, 120, 120) !important;}.wrc_middle_actions_grey_button:active {	background-color: rgb(130, 130, 130) !important;	border: 2px solid #00aaaa;}.wrc_middle_action_low {	font-size: 0.9em;	white-space: nowrap;	cursor: Pointer;	color: grey !important;	margin: 10px 10px 0px 10px;	text-decoration: none;}.wrc_middle_action_low:hover {	color: #aa4400 !important;}.wrc_middle_actions_rest_div {	padding-top: 5px;	white-space: nowrap;	text-align: center;}.wrc_middle_action {	white-space: nowrap;	cursor: Pointer;	color: red !important;	font-size: 1.2em;	margin: 10px 10px 0px 10px;	text-decoration: none;}.wrc_middle_action:hover {	color: #aa4400 !important;}</style><script id="wrc-script-middle_window" type="text/javascript" language="JavaScript">var g_inputsCnt = 0;var g_InputThis = new Array(null, null, null, null);var g_alerted = false;/* we test the input if it includes 4 digits   (input is a part of 4 inputs for filling the credit-card number)*/function is4DigitsCardNumber(val){	var regExp = new RegExp('[0-9]{4}');	return (val.length == 4 && val.search(regExp) == 0);}/* testing the whole credit-card number 19 digits devided by three '-' symbols or   exactly 16 digits without any dividers*/function isCreditCardNumber(val){	if(val.length == 19)	{		var regExp = new RegExp('[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{4}');		return (val.search(regExp) == 0);	}	else if(val.length == 16)	{		var regExp = new RegExp('[0-9]{4}[0-9]{4}[0-9]{4}[0-9]{4}');		return (val.search(regExp) == 0);	}	return false;}function CheckInputOnCreditNumber(self){	if(g_alerted)		return false;	var value = self.value;	if(self.type == 'text')	{		if(is4DigitsCardNumber(value))		{			var cont = true;			for(i = 0; i < g_inputsCnt; i++)				if(g_InputThis[i] == self)					cont = false;			if(cont && g_inputsCnt < 4)			{				g_InputThis[g_inputsCnt] = self;				g_inputsCnt++;			}		}		g_alerted = (g_inputsCnt == 4);		if(g_alerted)			g_inputsCnt = 0;		else			g_alerted = isCreditCardNumber(value);	}	return g_alerted;}function CheckInputOnPassword(self){	if(g_alerted)		return false;	var value = self.value;	if(self.type == 'password')	{		g_alerted = (value.length > 0);	}	return g_alerted;}function onInputBlur(self, bRatingOk, bFishingSite){	var bCreditNumber = CheckInputOnCreditNumber(self);	var bPassword = CheckInputOnPassword(self);	if((!bRatingOk || bFishingSite == 1) && (bCreditNumber || bPassword) )	{		var warnDiv = document.getElementById("wrcinputdiv");		if(warnDiv)		{			/* show the warning div in the middle of the screen */			warnDiv.style.left = "0px";			warnDiv.style.top = "0px";			warnDiv.style.width = "100%";			warnDiv.style.height = "100%";			document.getElementById("wrc_warn_fs").style.display = 'none';			document.getElementById("wrc_warn_cn").style.display = 'none';			if(bFishingSite)				document.getElementById("wrc_warn_fs").style.display = 'block';			else				document.getElementById("wrc_warn_cn").style.display = 'block';			warnDiv.style.display = 'table';		}	}}</script><style id="wrc-css" type="text/css">.wrcx {display:none} .r .wrcx, .osl .wrcx, .bc .wrcx, .fc .wrcx, #rhsline ol .wrcx {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/grey0-16.png") right no-repeat}
.wrc0 {display:none} .r .wrc0, .osl .wrc0, .bc .wrc0, .fc .wrc0, #rhsline ol .wrc0 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/grey0-16.png") right no-repeat}
.wrc11 {display:none} .r .wrc11, .osl .wrc11, .bc .wrc11, .fc .wrc11, #rhsline ol .wrc11 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/green1-16.png") right no-repeat}
.wrc12 {display:none} .r .wrc12, .osl .wrc12, .bc .wrc12, .fc .wrc12, #rhsline ol .wrc12 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/green2-16.png") right no-repeat}
.wrc13 {display:none} .r .wrc13, .osl .wrc13, .bc .wrc13, .fc .wrc13, #rhsline ol .wrc13 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/green3-16.png") right no-repeat}
.wrc21 {display:none} .r .wrc21, .osl .wrc21, .bc .wrc21, .fc .wrc21, #rhsline ol .wrc21 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/yellow1-16.png") right no-repeat}
.wrc22 {display:none} .r .wrc22, .osl .wrc22, .bc .wrc22, .fc .wrc22, #rhsline ol .wrc22 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/yellow2-16.png") right no-repeat}
.wrc23 {display:none} .r .wrc23, .osl .wrc23, .bc .wrc23, .fc .wrc23, #rhsline ol .wrc23 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/yellow3-16.png") right no-repeat}
.wrc31 {display:none} .r .wrc31, .osl .wrc31, .bc .wrc31, .fc .wrc31, #rhsline ol .wrc31 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/red1-16.png") right no-repeat}
.wrc32 {display:none} .r .wrc32, .osl .wrc32, .bc .wrc32, .fc .wrc32, #rhsline ol .wrc32 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/red2-16.png") right no-repeat}
.wrc33 {display:none} .r .wrc33, .osl .wrc33, .bc .wrc33, .fc .wrc33, #rhsline ol .wrc33 {display:inline; background: url("chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/red3-16.png") right no-repeat}
.wrc_icon{margin:0;padding:0;padding-left:15px !important; margin-left: 5px; width:16px !important; height:16px !important;line-height:16px !important;}
#wrchoverdiv{padding-bottom:20px;-webkit-border-radius: 4px; -webkit-box-shadow: 2px 2px 1px rgba(0,0,0,0.2); position:absolute; width:180px; background:transparent url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/background-body.jpg) top left repeat-x; display:none; font-family: Segoe UI, Arial Unicode MS, Arial, Sans-Serif; font-size: 14px; z-index:9999999;}
#wrchoverdiv{cursor:default;}
#wrchoverdiv #wrccontainer{width:180px;}
#wrchoverdiv #wrcheader{width:140px; height:42px; background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/logo.jpg) bottom left no-repeat; text-align:right; line-height:42px; color:orange; margin:0 auto;}
#wrchoverdiv .wrchorizontal{width:180px; height:2px; background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/horizontal-line.jpg) bottom left no-repeat;}
#wrchoverdiv #wrccurrentvote{height:25px; line-height:25px; color:#FFF; text-align:center; text-transform:uppercase;}
#wrchoverdiv #wrcrating{margin:5px auto; width:69px; height:55px; background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/grey-0.png) bottom left no-repeat;}
#wrchoverdiv #wrcrating.wrcbx{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/grey-0.png);}
#wrchoverdiv #wrcrating.wrcb0{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/grey-0.png);}
#wrchoverdiv #wrcrating.wrcb11{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/green-1.png);}
#wrchoverdiv #wrcrating.wrcb12{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/green-2.png);}
#wrchoverdiv #wrcrating.wrcb13{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/green-3.png);}
#wrchoverdiv #wrcrating.wrcb21{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/yellow-1.png);}
#wrchoverdiv #wrcrating.wrcb22{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/yellow-2.png);}
#wrchoverdiv #wrcrating.wrcb23{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/yellow-3.png);}
#wrchoverdiv #wrcrating.wrcb31{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/red-1.png);}
#wrchoverdiv #wrcrating.wrcb32{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/red-2.png);}
#wrchoverdiv #wrcrating.wrcb33{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/red-3.png);}
#wrchoverdiv #wrcratingtext{margin:3px 5px; color:#FFF; text-align:center; padding:0; font-size:12px;}
#wrchoverdiv #wrcweighttext{margin:3px 5px; color:#FFF; text-align:center; padding:0; font-size:12px;}
#wrchoverdiv #wrcflags{width:150px; height:70px; margin:0 auto;}
#wrchoverdiv .wrcicon{width:30px; height:30px; float:left;}
#wrchoverdiv #wrcicon_shopping{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/shopping-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_shopping.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/shopping-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_social{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/social-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_social.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/social-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_news{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/news-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_news.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/news-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_it{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/it-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_it.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/it-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_corporate{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/corporate-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_corporate.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/corporate-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_pornography{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/pornography-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_pornography.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/pornography-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_violence{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/violence-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_violence.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/violence-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_gambling{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/gambling-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_gambling.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/gambling-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_drugs{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/drugs-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_drugs.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/drugs-small-selected.png) top left no-repeat;}
#wrchoverdiv #wrcicon_illegal{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/illegal-small-disable.png) top left no-repeat;}
#wrchoverdiv #wrcicon_illegal.selected{background:url(chrome-extension://icmlaeflemplmjndnaapfdbbnpncnbda/skin/images/icons/illegal-small-selected.png) top left no-repeat;}
</style></head><body bgcolor="#D0FFD0"><div id="y5937935-banner"><table class="header"><tbody><tr><td><div class="direct"><a href="http://direct.yandex.ru/">Яндекс.Директ</a></div><wbr><div class="go-ad-how"><a target="_blank" href="http://welcome.advertising.yandex.ru/direct/?from=context">Дать объявление</a></div></td><td class="right"><div class="go-ad-all"><a href="http://direct.yandex.ru/search?from=http://white55.narod.ru/cmd.html&ref-page=77160" target="_blank">Все объявления</a></div><wbr><div class="close" onclick="y5_closeBanner(937935,this);"><span class="text">Закрыть</span><span>&nbsp;[&#215;]</span></div></td></tr></tbody></table><table class="data"><tbody><tr><td width="33%" class="block"><div class="ad"><div class="ad-link"><a href="http://bs.yandex.ru/count/HAsuUGCpf5G40000ZhOgin85XPZM4fK2cm5kGxS29OYadPnmYPBzTfXOdPa-3PQgT9l4kldL82isCXFx3vAa91m7fWQAeSvR1Ae1fPo0Pv6xlkYz1O-jeEYxdxLJNXi5aua9cJb2Z91n0g2GSGAla742fvSu0QYWScPKfB0m0W0fh0ckz3HFOAHbYTO4iG5x4000" target="_blank">Удилища и катушки Shimano</a></div><div>Удилища и катушки Shimano - большой выбор! Бюджетные и элитные модели.</div> <span class="url"><script type="text/javascript">yandex_direct_phonePrint();</script><a href="" target="_blank"></a>www.efish.ru</span></div></td><td width="33%" class="block"><div class="ad"><div class="ad-link"><a href="http://bs.yandex.ru/count/HAsuUL9gx7840000ZhOgin85XPZM4fK2cm5kGxS29JA8i71Um0E9gDb_oPX9dQdRAGkSkyTHQGMMgdIRnBhvrI0hDZ8J-m-QfdLyoPAZBWotfZkAh-8BNwe1fQHWrW6HkxxelGMFimQO7mUVlLQTGWIJYGcPLqACaCG9e9342Q-Gn0cdZ22ef3LkKAIm0000AQxqD4zWf6M9rWIn0NaI" target="_blank">Заработай 30000 р. в день!</a></div><div>Простая система, гарантированный результат!</div> <span class="url">piratemarketing.ru</span></div></td><td width="33%" class="block"><div class="ad"><div class="ad-link"><a href="http://bs.yandex.ru/count/HAsuUPR7IIK40000ZhOgin85XPZM4fK2cm5kGxS29JE8lUvSq069eoG2BfYkpRo-dQSbE0MMgdIRnBhvrI0hDZ8J-m-IgXqvHwOSYgT7AY2g0QMdh2y1aRk-wBq5ZxWU00G2dxCzFXCDaua9cJb2Z90r3A2GDGola3KCfuePgASMhGIai30202ci2QxqD4zWf6M9rWIn0NiH" target="_blank">Сайт огромных скидок 50-90%</a></div><div>Развлечения, рестораны, салоны красоты, фитнес, спорт, кино, театры, товары</div> <span class="url">kuponator.ru</span></div></td></tr></tbody></table></div><div style="background:url(http://www.tns-counter.ru/V13a****yandex_ru/ru/CP1251/tmsec=narod_total/)"></div>                          


<meta name="Generator" content="Microsoft FrontPage 4.0">
<title>Командные файлы</title>

<br><br> 

<table width="100%">
<tbody><tr>



<!--  Левый отступ  -->
<td width="5%">
</td>
<!-- Основная колонка -->

<td width="90%">


<a href="http://white55.narod.ru/cmd.html#id0">Общий подход.</a><br>
<a href="http://white55.narod.ru/cmd.html#id1">Использование переменных окружения.</a><br>
<a href="http://white55.narod.ru/cmd.html#id2">Передача параметров командному файлу.</a><br>
<a href="http://white55.narod.ru/cmd.html#id3">Переходы и метки.</a><br>
<a href="http://white55.narod.ru/cmd.html#id4">Примеры:</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id5">Создание новых файлов</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id51">Присвоение съемному диску одной и той же буквы.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id6">Создание поколений архивов по датам и времени.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id61">Создание архивов - более сложный вариант.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id7">Выполнение команд по расписанию.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id8">Запуск и остановка служб.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id9">Выдача на экран значения ERRORLEVEL.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id10">Диалог с пользователем.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id100">Задержки в командных файлах.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id11">Поиск в локальной сети компьютеров с запущенным приложением.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id12">Поиск компьютеров с запущенным приложением по списку.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id13">Выключение компьютеров по списку, созданному на основе сетевого окружения.</a><br>
&nbsp; &nbsp; - <a href="http://white55.narod.ru/cmd.html#id14">Работа с оконными приложениями.</a><br>

<a href="http://white55.narod.ru/cmd.html#id20">Типичные ошибки.</a><br>
<a href="http://white55.narod.ru/cmd.html#id21">Использование командных файлов в сценариях регистрации.</a><br>

<b><font color="#0000ff"><p align="CENTER"></p>
<h3 id="id0">
<p align="CENTER">Общий подход.</p>
<p align="CENTER"></p> </h3>
<p align="CENTER">&nbsp; </p>
</font></b><p><font color="#0000ff">   </font>
<font size="3"></font></p><p><font size="3"> </font></p><font size="3">
<p>  Командные файлы – это текстовые файлы с расширением <b>bat </b>или 
<b>cmd</b>, строки которых представляют собой команды или имена исполняемых 
файлов. 
Когда вы запускаете на выполнение командный файл, то управление получает 
командный процессор операционной системы  (часто называемый интерпретатором 
команд),  который последовательно считывает и интерпретирует строки командного 
файла. Для Windows9X этим занимается <b>command.com</b>, для WinNT/2K/XP – 
<b>cmd.exe</b>. Строки командных файлов могут содержать команды самого 
процессора команд  (FOR, GOTO, IF и т.п.) или имена исполняемых модулей 
(net.exe, regedit.exe, win.com и т.п.). 
В операционных системах WinNT/2K/XP можно получить краткую справку по 
составу команд с помощью командной строки:</p>
</font><b><font size="3" color="#0000ff"><p>HELP</p>
</font></b><font size="3"><p>или по конкретной команде:</p>
</font><b><font size="3" color="#0000ff"><p> HELP  Имя команды </p>
</font></b><font size="3"><p>     Для выдачи текста справки не на экран, а 
в файл, 
можно воспользоваться <b><i>перенаправлением вывода</i></b>. При использовании 
командной строки, стандартным 
устройством ввода является клавиатура, а устройством вывода – дисплей, 
однако эти устройства можно переназначить с использованием символов 
перенаправления 
</p>
</font><b><font size="3" color="#0000ff"></font></b><p><b><font size="3" color="#0000ff">&lt; </font><font size="3"> - </font></b><font size="3">
перенаправление ввода </font></p><font size="3">
</font><b><font size="3" color="#0000ff"></font></b><font size="3" color="#0000ff"></font><p><font size="3" color="#0000ff"><b> &gt;</b></font><font size="3">- 
перенаправление вывода (или <font color="#0000FF"> &gt; &gt; </font> - 
перенаправление в существующий файл, когда выводимые данные 
дописываются в конец файла.) </font></p><font size="3">

</font><p><font size="3">Для вывода потока данных команды </font><b><font size="3" color="#ff0000">HELP</font></b><font size="3"> в файл help.txt 
командная строка будет следующей:</font></p><font size="3">
</font><b><font size="3" color="#0000ff">
<p>HELP  &gt; help.txt</p>
</font></b><font size="3">
<p>Для вывода справки по команде GOTO в файл goto.txt:</p>
</font><b><font size="3" color="#0000ff">
<p>HELP GOTO  &gt; goto.txt</p>
</font><font color="#0000ff"><p align="CENTER"></p>
</font>
<h3 id="id1">
<p align="CENTER">
Использование переменных окружения. </p>
<p align="CENTER"></p>
</h3>
<font size="3"></font></b><font size="3"></font><p><font size="3"><b>  </b>В командных файлах можно, а зачастую, и нужно  
использовать <b><i>переменные окружения</i></b> – переменные, значения 
которых характеризуют среду, в которой выполняется команда или пакетный файл. 
Значения переменных окружения формируются при загрузке ОС и регистрации 
пользователя в системе, а также могут быть заданы с помощью 
команды </font><b><font size="3" color="#ff0000">SET</font></b><font size="3"> , 
формат которой:</font></p><font size="3">
</font><b><font size="3" color="#0000ff">
<p>SET [переменная=[строка]]</p>
</font></b><font size="3"><p align="CENTER"></p>
<b></b><p><b>  переменная</b> Имя переменной среды.</p>
<b></b><p><b>  строка  </b>   Строка символов, присваиваемая указанной переменной.</p>

<p>Например, командная строка</p>
<b><p> SET mynane=Vasya</p>
</b><p>добавит переменную myname, принимающую значение Vasya. </p>
<p>     Можно получить значение переменной в программах и командных 
файлах, используя ее имя, заключенное в знаки процента (<b>%)</b>. Например 
команда </p>
<b><p>ECHO time</p>
</b><p>выведет на экран слово time, а команда </p>
<b><p>ECHO %time%</p>
</b><p>выведет на экран значение переменной time, принимающей значение 
текущего времени.</p>
<p>А командная строка </p>
<b><p>SET PATH=C:\myprog;%path%</p>
</b><p>добавит в путь поиска исполняемых программ, описываемый значением 
переменной PATH каталог C:\myprog</p>

<p>   Выполнение команды SET без параметров вызывают выдачу текущих 
значений переменных на экран, в виде:</p>

<p>NUMBER_OF_PROCESSORS=1 - количество процессоров</p>
<p>OS=Windows_NT- тип ОС</p>
<p>Path=E:\WINDOWS\system32;E:\WINDOWS;E:\Program Files\Far - путь поиска исполняемых файлов.</p>
<p>PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH - расширения для исполняемых файлов.</p>
<p>PROCESSOR_ARCHITECTURE=x86 - архитектура процессора.</p>
<p>PROCESSOR_IDENTIFIER=x86 Family 6 Model 8 Stepping 1, AuthenticAMD - идентификатор процессора.</p>
<p>PROCESSOR_LEVEL=6 - уровень (номер модели) процессора.</p>
<p>PROCESSOR_REVISION=0801 - версия процессора.</p>
<p>ProgramFiles=E:\Program Files - путь к папке "Program Files"</p>
<p>PROMPT=$P$G - формат приглашения командной строки $P - путь для текущего каталога $G - знак "&gt;".</p>
<p>SystemDrive=E: - буква системного диска.</p>
<p>SystemRoot=E:\WINDOWS - каталог ОС Windows.</p>
</font><b><font color="#0000ff"><p> </p>
</font></b><font size="3"><p>   <b><i>Значение некоторых переменных по команде SET не выдаются. Это переменные, значения которых динамически изменяются :</i></b></p><b><i>
</i></b>
<p>%CD% - Принимает значение  строки текущей директории.</p>
<p align="CENTER"></p>
<p>%DATE% - Принимает значение текущей даты.</p>
<p align="CENTER"></p>
<p>%TIME% - Принимает значение текущего времени.</p>
<p align="CENTER"></p>
<p>%RANDOM% - Принимает значение случайного десятичного числа в диапазоне 1 -32767.</p>
<p align="CENTER"></p>
<p>%ERRORLEVEL% - Принимает текущее значение кода завершения задачи ERRORLEVEL</p>
<p align="CENTER"></p>
<p>%CMDEXTVERSION% - Принимает значение версии  командного процессора CMD.EXE для расширенной обработки команд.</p>
<p align="CENTER"></p>
<p>%CMDCMDLINE% - Принимает значение строки, которая вызвала командный процессор.</p>
<p> </p>
<p>Для просмотра значения переменной можно использовать командную строку:</p>
</font><b><font size="3" color="#0000ff"><p>ECHO %переменная%</p>
</font></b><font size="3">
<b>
</b><h3 id="id2"><b>
<p align="CENTER">Входные параметры для командного файла.</p>
</b>
</h3>
<p>   Существует возможность передать командному файлу параметры командной 
строки и использовать их значения в операторах самого командного файла.</p>
</font><b><font size="3" color="#0000ff">
<p>BAT-файл  &lt; параметр1 &gt; , &lt; параметр2 &gt;, ... &lt; параметрN &gt; </p>
</font></b><font size="3"><p>  В самом командном файле первый параметр будет доступен как переменная <b>%1</b>, 
второй - <b>%2 </b>и т.п. Имя самого командного файла доступно как переменная <b>%0</b>. 
Для примера создадим командный файл, задачей которого будет выдача на экран значений введенных параметров.  Обычно для вывода 
текста используется команда </p>
<p>ECHO &lt; текст &gt; </p>
<p>Однако если текст заменить на %1, - то будет выдан первый параметр, 
на %2 - второй и т.д.</p>
<p>Создаем файл parm.bat следующего содержания:</p>

<p>echo Первый параметр=%1</p>
<p>echo Второй параметр=%2</p>
<p>echo Третий параметр = %3</p>

<p>   и запускаем его на выполнение следующей командой:</p>
<b>
<p>parm.bat FIRST second “two words”</p>
</b>
</font><p><font size="3">после его выполнения вы поймете, как это работает и что параметры с пробелами, нужно заключать в двойные кавычки. Для того, чтобы обрабатываемые командным процессором строки не выдавались на экран, можно воспользоваться командой </font><b><font size="3" color="#0000ff">ECHO OFF</font></b><font size="3">, поместив ее в первую строку командного файла. Для того, чтобы строка командного файла игнорировалась командным процессором поместите в ее начало </font><b>
<font size="3" color="#0000ff">REM&lt; пробел &gt; </font></b><font size="3" color="#0000ff"> </font><font size="3">.  
Таким образом можно помещать комментарии, зачастую нелишние в 
больших командных файлах:</font></p><font size="3">

<p>rem ECHO OFF выключает режим вывода содержания строк командного 
файла на экран</p>
<p>REM будет выводиться только результат их выполнения.</p>
<p>ECHO OFF</p>
<p>echo Первый параметр=%1</p>
<p>echo Второй параметр=%2</p>
<p>echo Третий параметр = %3</p>
<p>Попробуйте ECHO OFF заменить на @ECHO OFF – результат говорит сам за себя. Строка, которая выключает режим вывода, перестала выдаваться на экран.</p>

<p>&nbsp;</p>
</font><b><font size="3" color="#0000ff"><p>&nbsp;</p>
</font>
<h3 id="id3">
<p align="CENTER">Переходы и метки.</p>
<p align="CENTER"></p>
</h3>
</b><font size="3"><p>   В командных файлах можно использовать команды условного перехода, меняющие логику их работы в зависимости от выполнения определенных условий.  Для иллюстрации приемов использования условных переходов создадим командный файл, целью которого будет присвоение заранее определенной буквы диска для съемных носителей, в качестве которых будут использоваться флэш-диски. Условия таковы – есть 2 флэш-диска, один из которых должен быть виден в проводнике как диск X: а второй – как диск Y: независимо от того, в какой порт USB они подключены. Будем считать, что реальные диски могут быть подключены как F: или G: Опознавание дисков будем выполнять по наличию файла с определенным именем (лучше такой файл сделать скрытым в корневом каталоге и назвать его как-нибудь необычно):</p>
<p>Flashd1.let – на первом диске</p>
<p>Flashd2.let – на втором</p>
<p>   Т.е. задача командного файла заключается в том, чтобы  проверить наличие на сменных дисках <b>F:</b> и <b>G:</b> файлов <b>Flashd1.let</b> или <b>Flashd2.let</b> и, в зависимости от того, какой из них присутствует, присвоить диску букву <b>X:</b> или <b>Y:</b></p><b>
</b></font><p><font size="3">Для поиска файла на диске  используем команду </font><b><font size="3" color="#ff0000">IF EXIST</font></b><font size="3">:</font></p><font size="3">
</font><b><font size="3" color="#0000ff"><p>IF EXIST имя_файла команда</p>
</font></b><font size="3"></font><p><font size="3">В качестве команды проще всего воспользоваться </font><b><font size="3" color="#ff0000">SUBST</font></b><font size="3">, сопоставляющей имя диска и каталог.</font></p><font size="3">
</font><b><font size="3" color="#0000ff"></font></b><font size="3" color="#0000ff"></font><p><font size="3" color="#0000ff"><b>SUBST X: C:\  - </b></font><font size="3">создает виртуальный диск X:, содержимым которого будет корневой каталог диска C:</font></p><font size="3">
<p>Создаем командный файл setXY.bat со следующими строками:</p>

<p>@ECHO OFF</p>
<p>IF EXIST G:\flashd1.let SUBST X: G:\</p>
<p>IF EXIST F:\flashd1.let SUBST X: F:\</p>
<p>IF EXIST G:\flashd2.let SUBST Y: G:\</p>
<p>IF EXIST F:\flashd2.let SUBST Y: F:\</p>

<p>   После выполнения такого файла у вас появятся диски X: и Y: Но если такой файл выполнить повторно, 
команда SUBST выдаст сообщение об ошибке – ведь диски X: и Y: уже существуют. </p>
</font><p><font size="3">Желательно обойти выполнение SUBST, если виртуальные диски X: и Y:  уже созданы, (или  удалять их, используя SUBST с параметром –d перед подключением ).  Модифицируем командный файл с использованием </font><b><font size="3" color="#ff0000">GOTO</font></b><font size="3"> - передачи управления строке пакетного файла по метке.</font></p><font size="3">

</font><b><font size="3" color="#0000ff"><p>GOTO метка</p>
</font></b><font size="3">
<p>Метка должна находиться в отдельной строке и начинаться с двоеточия. Сделаем изменения в нашем командном файле, чтобы не возникало сообщений об ошибке:</p>

<p>@ECHO OFF</p>
<p>REM если не существует X: - то перейдем на метку SETX</p>
<p>IF NOT EXIST X:\ GOTO SETX</p>
<p>REM если существует X: - перейдем на проверку наличия Y:</p>
<p>GOTO TESTY</p>
<p>:SETX</p>
<p>IF EXIST G:\flashd1.let SUBST X: G:\</p>
<p>IF EXIST F:\flashd1.let SUBST X: F:\</p>
<p>:TESTY</p>
<p>REM если Y: существует – завершим командный файл.</p>
<p>IF EXIST Y:\ GOTO EXIT</p>
<p>IF EXIST G:\flashd2.let SUBST Y: G:\</p>
<p>IF EXIST F:\flashd2.let SUBST Y: F:\</p>
<p>REM выход из командного файла</p>
<p>:EXIT</p>

</font><p><font size="3">Сообщение об ошибке SUBST исчезло. Признаки ошибок при выполнении команд можно отслеживать и в самом командном файле, анализируя переменную </font><b><font size="3" color="#ff0000">ERRORLEVEL</font></b><font size="3">, значение которой формируется при выполнении большинства программ. ERRORLEVEL равно 0, если программа завершилась без ошибок и 1 – при возникновении ошибки. Могут быть и другие значения, если они предусмотрены в выполняемой программе. </font></p><font size="3">
</font><p><font size="3">    В качестве команды в строке командного файла можно использовать также командный файл. Причем, для передачи с возвратом обратно к точке выполнения вызывающего командного файла используется 
команда </font><b><font size="3" color="#ff0000">CALL</font></b><font size="3"> . Создадим командный файл test.bat, следующего содержания:</font></p><font size="3">

<p>@ECHO OFF</p>
<p>ECHO Вызов 1.bat</p>
<p>CALL 1.bat</p>
<p>ECHO Возврат.</p>

<p>   </p>
</font><p><font size="3">И файл 1.bat, содержащий команду </font><b><font size="3" color="#ff0000">PAUSE</font><font size="3">, </font></b><font size="3">приостанавливающую выполнение командного файла до нажатия любой клавиши.</font></p><font size="3">

<p>&nbsp; </p>
<p>@ECHO OFF</p>
<p>pause</p>
<p> </p>
<p>   При выполнении test.bat будет выдано на экран сообщение </p>

<p>Вызов 1.bat</p>

<p>и управление получит 1.bat с командой pause. После начатия клавиши на клавиатуре управление получит  
командная строка “ECHO Возврат.”  и на экран будет выдано </p>

<p>Возврат.</p>

<p>Если же в test.bat убрать CALL , то возврат из файла 1.bat выполняться не будет. Кстати, используя передачу управления командному файлу, можно организовать его зацикливание. Попробуйте добавить в конец файла test.bat строку:</p>

<p>CALL test.bat</p>
<b>
</b><i><p>   Выйти из зацикливания командного файла можно по нажатию комбинации CTRL-Break. 
Возможно использование команды CALL для вызова процедуры внутри командного файла. 
В этом случае в качестве аргумента используется не имя внешнего файла, а метка:<br>
....<br>
call :proc1<br>
....<br>
:proc1<br>
....<br>
exit<br>
....<br>

</p>
</i>

<p>&nbsp; </p>
</font><b><p align="CENTER">&nbsp; </p>

</b><h3 id="id4"><b>
<p align="CENTER">Примеры</p>
</b>
</h3>

<font size="3">
</font><b><font size="3" color="#0000ff">
<h3 id="id5">
<p align="CENTER">Создание файлов.</p></h3>

</font></b><font size="3">
<p>     В Windows нет специальной команды для создания файла, но без нее можно легко обойтись несколькими способами:</p>
<p>Копирование с консоли в файл </p>
<p>COPY CON myfile.txt</p>
<p>При выполнении этой команды данные с клавиатуры (устройство CON) будут заноситься в файл myfile.txt. Нажатие клавиши F6 или комбинации CTRL-Z завершит вывод.</p>

<p>Перенаправление вывода </p>
<p>ECHO 1  &gt; myfile.txt</p>
<p>При выполнении этой команды будет создан файл myfile.txt, содержащий символ “1”</p>
<p>   Комбинация перенаправления ввода и вывода:</p>

<p>COPY CON &gt; myfile.txt &lt; xyz</p>
<p>При выполнении этой команды, как и в первом случае, используется копирование 
с консоли в файл, но вместо данных с клавиатуры  используется ввод с 
несуществующего устройства xyz. Система выдаст сообщение, о том, что такого устройства 
не существует, но пустой файл myfile.txt будет успешно создан. <br>
Совсем простой вариант - копирование с фиктивного устройства с именем <b>nul</b> 
в файл. <br>
copy nul myfile.txt<br><br>


&nbsp; &nbsp;
Если вам часто приходится создавать пустые файлы, можно подготовить свой 
командный файл (например – newfile.bat или, что еще лучше, - nf.bat), 

а имя создаваемого файла передавать ему в качестве параметра при запуске. </p>

<p>Содержимое файла:</p>

<p>@ECHO OFF</p>
<p>copy nul %1 </p>
&nbsp; &nbsp; 
Поместите этот командный файл в системный каталог 
(C:\windows\system32 или любой другой, имеющийся в путях поиска, 
задаваемых PATH). 
<p>Командная строка:</p>

<p><b>newfile.bat myfile.txt</b></p>
или<br>
<p><b>nf.bat myfile.txt</b></p>
или<br>
<b>nf myfile.txt</b><br><br>
&nbsp; &nbsp;
Вот вам и команда <b> nf </b> для создания пустого файла в 
командной строке.<br><br>


<b><font size="+1" color="#0000ff">
</font></b><h3 id="id51"><b><font size="+1" color="#0000ff">
<p align="CENTER">Присвоение съемному диску одной и той же буквы.</p></font></b>
</h3>
&nbsp; &nbsp; Задача заключается в том, чтобы съемный USB диск (флэш диск) был доступен 
всегда под одной и той же буквой, независимо от того, на каком компьютере он используется 
и как он подключен. Для ее решения воспользуемся уже упоминаемой выше командой SUBST. 
Выберем для съемного диска желаемую букву, например - X. Имя диска, с которого 
был запущен командный файл доступно как переменная %~d0. Создаем командный файл 
следующего содержания:<br>
@echo off<br>
subst X: %~d0\<br>
что означает - создать виртуальный диск X:, которому сопоставлен 
физический диск, откуда был выполнен запуск командного файла.<br>

Дополнительное  представление о подстановочных значениях 
переменной %0 можно получить из командного файла следующего 
содержания: <br><br>
@echo off<br>
ECHO ОБРАБАТЫВАЕТСЯ ФАЙЛ   -         %0<br>
ECHO Дата/время создания/изменения командного файла -  %~t0<br>
ECHO Путь командного файла -        "%~f0"<br>
ECHO Диск командного файла -        %~d0<br>
ECHO Каталог командного файла -     "%~p0"<br>
ECHO Имя командного файла -         %~n0<br>
ECHO Расширение командного файла -  %~x0<br>
ECHO Короткое имя и расширение -    %~s0<br>
ECHO Атрибуты командного файла -    %~a0<br>
ECHO Размер командного файла -      %~z0<br><br>
<br><br>


<b><font size="+1" color="#0000ff">
</font></b><h3 id="id6"><b><font size="+1" color="#0000ff">
<p align="CENTER">Создание поколений архивов по датам и времени.</p></font></b>
</h3>
&nbsp; &nbsp; 
Решим следующую задачу - нужно создать архив файлов, находящихся в каталоге 
C:\Program Files\FAR. Имя архивного файла должно состоять из текущего времени 
(часы.минуты.секунды - ЧЧ.ММ.СС.rar), и помещен он должен в новый каталог, имя которого должно состоять из текущей даты 
(день.месяц.год - ДД.ММ.ГГГГ). Для архивирования будем использовать архиватор RAR. 
Формат запуска для создания архива:<br><br>
<b>RAR a -r &lt;  путь и имя архива  &gt; &lt;  Путь и имя архивируемых данных  &gt; </b><br><br>
<b>a </b>- команда создания архива.<br>
<b>-r</b> - ключ, определяющий архивирование подкаталогов (т.к. в исходной папке есть подкаталоги).<br><br>
Таким образом, для решения задачи нужно правильно создать имена и пути для RAR. Для чего 
воспользуемся следующими факторами: <br><br>
<li>
В командных файлах можно получить доступ к текущей дате и текущему времени - переменные %DATE% и  %TIME%
</li><li>
В командных файлах можно создавать временные переменные с помощью команды SET.<br>

</li></font><li><font size="3">
Значение временных переменных может быть сформировано на основе %DATE% и %TIME% путем пропуска и (или) 
замещения их частей с помощью все той же команды SET.<br><br>

Дата, получаемая из переменной %DATE% при стандартных настройках региональных установок 
выглядит следующим образом:<br>
<b>Пн 21.01.2005</b> - День недели(2 символа)-Пробел-дата(10 символов)<br>
Для примера, создадим каталог командой MD &lt;  имя каталога  &gt;.<br>
Создаем в памяти временную переменную VDATE и присваем ей значение 
переменной окружения DATE, без первых 3-х символов - 20.01.2005: <br><br>
set VDATE=%date:~3%<br><br>
Создаем каталог на диске C:, имя которого = текущая дата из переменной VDATE:<br><br>
MD C:\%VDATE%<br>
После выполнения этой команды на диске C: будет создан каталог с именем 20.01.2005
<br><br>

Время, получаемое из переменной %TIME%:<br>
<b>14:30:59.93</b> - Часы, минуты, секунды, сотые доли секунды. <br>
Сотые доли - это в имени файла архива, пожалуй, лишнее. Создаем временную 
переменную VTIME и присваиваем ей текущее время без последних 3-х символов<br>
set VTIME=%time:~0,-3%<br>
Теперь VTIME = 14:30:59, но знак " : " в имени файла использовать нельзя, 
поэтому заменим его на точку.<br>
set VTIME=%VTIME::=.%<br>
Переменная VTIME примет значение 14.30.59 Для имени файла сойдет.
<br><br>

Запустим архиватор:<br><br>
rar a -r C:\%VDATE%\%VTIME%.rar "C:\Program files\far\*.*"
<br><br>

Теперь можно создать командный файл с содержимым:<br><br>
set VDATE=%date:~3%<br>
md c:\%VDATE%<br>
set VTIME=%time:~0,-3%<br>
set VTIME=%VTIME::=.%<br>
rar a -r C:\%VDATE%\%VTIME%.rar "C:\Program files\far\*.*"<br><br>

&nbsp; &nbsp; 
Такой командный файл можно выполнять через автозагрузку, или как часть скрипта, 
при входе пользователя в домен, либо с помощью планировщика в заданное время, и у вас 
всегда будут в наличии упорядоченные по времени архивы критических данных.<br><br>


</font><b><font size="+1" color="#0000ff">
</font></b><h3 id="id61"><b><font size="+1" color="#0000ff">
<p align="CENTER">Создание архивов с использованием переменных профиля пользователя.</p></font></b>
</h3>
&nbsp; &nbsp; Этот командный файл создает архивы содержимого папки 
"Мои Документы" пользователей Win2K/XP, размещая их в каталоги<br>
C:\ARHIV\Мои документы\Имя пользователя\Дата\время<br> <br>
Используются переменные USERPROFILE, USERNAME, WINDIR, поэтому в WIN9X этот командный файл работать не будет.
 (Хотя, при желании вы можете вставить в autoexec.bat команды для установки значений этих переменных и 
использовать его в однопользовательском варианте практически без изменений).   
Содержимое командного файла снабжено комментариями и не должно вызывать особых затруднений, если вы разобрались с предыдущим 
примером:<br><br>


@echo off<br>
rem Задается переменная FROM - откуда брать данные для архивирования<br>
set FROM=%USERPROFILE%\Мои Документы<br>
rem Задается ппеременная TO - куда помещать архивы<br>
set TO=C:\arhiv\Мои документы\%USERNAME%<br>
rem Создадим каталог ТО<br>
md "%TO%\"<br>
rem Сформируем имя подкаталога из текущей даты<br>
rem текущая дата при настройках по умолчанию для Win2K - Пн 25.04.2005 <br>
rem текущая дата при настройках по умолчанию для WinXP - 25.04.2005 <br>
rem Из текущей даты сформируем имя подкаталога - 25.04<br>
rem По умолчанию Windir для WinXP - C:\WINDOWS, а для Win2K - C:\WINNT<br>
IF /I %Windir% == C:\WINNT GOTO Win2K<br>
set vdate=%DATE:~0,-5%<br>
GOTO SetFileName<br>
:Win2K<br>
set vdate=%DATE:~3,-5%<br>
rem Сформируем имя файла архива из текущего времени - 12:00:00.99<br>
rem отбросим сотые доли секунды и заменим символ : на символ . Результат - 12.00.00<br>
:SetFileName<br>
set vtime=%TIME:~0,-3%<br>
set vtime=%vtime::=.%<br>
rem Создадим подкаталог для файла архива<br>
md "%TO%\%VDATE%"<br>
rem Команда для архивирования. Ключ -r нужен для архивирования с вложенными папками<br>
rem вариант для архиватора ARJ : arj a -r "%TO%\%VDATE%\%VTIME%.arj" "%FROM%\*.*"<br>
rem При использовании архиватора RAR:<br>
rar a -r "%TO%\%VDATE%\%VTIME%.rar" "%FROM%\*.*"<br><br>






<font size="+1" color="blue">
</font><h3 id="id7"><font size="+1" color="blue">
<p align="CENTER">Выполнение команд по расписанию.</p>
</font>
</h3>
<font size="3">
</font><p><font size="3">В WIN2K/XP существует утилита командной строки </font><b><font size="3" color="#ff0000">AT</font><font size="3">, </font></b><font size="3">позволяющая выполнить команду или пакетный файл в указанное время на локальном или удаленном компьютере. Для использования команды AT необходимо, чтобы была   запущена служба планировщика 
заданий (обычно запущена по умолчанию при установке системы).</font></p><font size="3">
<p>                                               </p>
<b><p>AT [\\имя_компьютера] [ [код] [/DELETE] | /DELETE [/YES]]    </p>
</b><p>             </p>
<b><p>AT [\\имя_компьютера] время [/INTERACTIVE]</p>
<p>    [ /EVERY:день[,...] | /NEXT:день[,...]] "команда"</p>
</b>
<p>&nbsp; </p>
<b></b><p><b>\\имя_компьютера</b>   Имя удаленного компьютера. Если этот параметр опущен,  </p>
<p>                                   используется локальный компьютер.                        </p>
</font><font size="3" color="#ff0000">
</font><b><font size="3"></font></b><font size="3"></font><p><font size="3"><b>код    </b></font><font size="3" color="#ff0000">       </font><font size="3">             Порядковый номер запланированной задачи.  Указывается если нужно   отменить уже  запланированную задачу с помощью ключа <b>/delete</b>.      </font></p><font size="3">
</font><font size="3" color="#ff0000">
</font><b><font size="3"></font></b><font size="3"><p><b>/delete</b>            Отмена запланированной задачи. Если код задачи опущен,</p>
<p>                   отменяются все задачи, запланированные для указанного</p>
<p>                   компьютера.</p>
</font><font size="3" color="#ff0000">
</font><b><font size="3"></font></b><font size="3"><p><b>/yes</b>               Отмена запроса на подтверждение при отмене всех</p>
<p>                   запланированных задач.</p>
</font><font size="3" color="#ff0000">
</font><b><font size="3"></font></b><font size="3"><p><b>время  </b>            Время запуска команды.</p>
</font><font size="3" color="#ff0000">
</font><b><font size="3"></font></b><font size="3"><p><b>/interactive</b>       Разрешение взаимодействия задачи с пользователем,</p>
<p>                   работающим на компьютере во время запуска задачи. Задачи, запущенные без этого ключа невидимы для пользователя компьютера.</p>
</font><font size="3" color="#ff0000">
</font><b><font size="3"></font></b><font size="3"><p><b>/every:день[,...]</b>  Запуск задачи осуществляется по указанным дням недели или </p>
<p>                   месяца. Если дата опущена, используется текущий день</p>
<p>                   месяца.                                                   </p>
<b></b><p><b>/next:день[,...]</b>   Задача будет запущена в следующий указанный день недели   </p>
<p>                   (например в следующий четверг). Если дата опущена,        </p>
<p>                   используется текущий день месяца.</p>
<b></b><p><b>"команда"</b>          Команда или имя пакетного файла.</p>

<p>&nbsp; </p>
<p align="CENTER">Примеры использования:</p>

</font><p><font size="3">- Аналог “будильника” ,  - всплывающие окна с текстом,  напоминающие 
текущему или  указанному пользователю о необходимости 
выполнения каких-нибудь действий. Для отправки сообщения пользователю 
используем утилиту</font><b><font size="3" color="#ff0000"> NET.EXE</font></b></p><b><font size="3" color="#ff0000">
</font></b><font size="3">
<b><p>AT 13:50 net.exe send * Пора пить кофе </p>
<p>AT 17:50 net.exe send User Пора домой </p>
<p>AT \\SERVER 13:45 net.exe send  Нужно перезагрузить сервер</p>
</b>
<p>- Просмотр списка запланированных задач:</p>
<b><p>AT</p>
</b><i>
</i><p> - Удаление уже спланированных задач:</p>

<b></b><p><b>AT 3 /DELETE</b> – удаление задачи с номером 3</p>
<b></b><p><b>AT /DELETE /YES</b> – удаление всех задач</p>

<i><p>“Панель управления” - “Назначенные задания” позволяют просматривать, изменять и удалять созданные командой <b>AT</b> задания.</p>
</i>
<p>&nbsp; </p>
</font><b><font size="3" color="#0000ff">
<h3 id="id8">
<p align="CENTER">Остановка и запуск системных сервисов.</p>
<p align="CENTER"></p>
</h3>

<p align="CENTER">&nbsp; </p>
</font></b><p><font size="3" color="#0000ff">   </font><font size="3">Для остановки и запуска служб Win2K/XP из 
командной строки используется команда NET.EXE</font></p><font size="3">
</font><b><font size="3" color="#0000ff"><p>NET.EXE STOP &lt; имя службы &gt; </p>
<p>NET.EXE START &lt; имя службы &gt; </p>
</font></b><font size="3"><p>    
Возможно использование как короткого, так и полного имени ("Dnscache" - короткое, 
"DNS-клиент" - полное имя службы). 
Имя службы, содержащее пробелы заключается в двойные кавычки.  Пример перезапуска службы “DNS-клиент”</p>

</font>
<b><font size="3" color="#0000ff"><p>net stop "DNS-клиент" </p>
<p>net start "DNS-клиент" </p>
</font></b><font size="3">
То же, с использованием короткого имени:<br>
<b><font size="3" color="#0000ff"><p>net stop Dnscache </p>
<p>net start Dnscache </p>
</font></b><font size="3">


<p>   <i>Полное имя службы можно скопировать из “Службы” – &lt; Имя службы &gt; - “Свойства”  -  “Выводимое имя”</i></p><i>
Для управления службами гораздо удобнее воспользоваться утилитой PsService.exe из 
<a target="_blank" href="http://white55.narod.ru/pstools.html">утилит PsTools</a>
Утилита не требует установки и работает в любой OS Windows. Кроме запуска и 
остановки службы, 
позволяет выполнить поиск конкретной службы на компьютерах локальной сети, опросить 
состояние и конфигурацию службы, изменить тип запуска, приостановить службу, 
продолжить, перезапустить.
 

<br><br>
</i>
&nbsp; &nbsp; 
Для работы с системными службами в Windows XP можно использовать утилиту <b>sc.exe</b>, 
позволяющую не только остановить/запустить службу, но и опросить ее состояние, параметры 
запуска и функционирования, изменить конфигурацию, а также работать не только 
с системными службами, 
но и с драйверами. При наличии прав, имеется возможность управлять 
службами не только на локальной, но и на удаленной машине. Примеры:<br>
<b>sc.exe stop DNSCache </b>- остановить службу DNSCache на локальном компьютере.<br>
<b>sc \\192.168.0.1 query DNSCache</b> - опросить состояние службы DNSCache на компьютере c 
IP-адресом 192.168.0.1<br>
<b>sc \\COMP start DNSCache</b> запустить службу DNSCache на компьютере COMP<br>
Подсказку по работе с утилитой можно получить, введя:<br>
<b>sc /?</b><br>

<br><br>
</font><b><font size="+1" color="#0000ff">
</font></b><font size="+1" color="#0000ff"></font><h3 id="id9"><font size="+1" color="#0000ff"><b>
<p align="CENTER">Выдача на экран значения переменной ERRORLEVEL .</p>
</b></font>
</h3>
<font size="3">
&nbsp; &nbsp;
Этот простенький командный файл выдаст на экран значение переменной ERRORLEVEL по 
конкретной командной строке. Вначале выполняется проверка на наличие хотя бы одного 
входного параметра, и если ничего не задано, выдается сообщение об ошибке и происходит завершение 
по exit. Если же хотя бы один параметр задан, то входные параметры считаются  командной 
строкой и выполняются, а значение ERRORLEVEL выдается с помощью команды ECHO. 
Содержимое файла (я назвал его echoEL.bat):<br><br>

@echo off<br>
if "%1" NEQ "" GOTO PARMOK<br>
ECHO Нужно задать командную строку для определения ERRORLEVEL<br>
exit<br>
:PARMOK<br>
%1 %2 %3 %4 %5 %6 %7 %8<br>
ECHO %1 %2 %3 %4 %5 %6 %7 %8 ERRORLEVEL=%ERRORLEVEL%<br><br>
<center>Примеры запуска: <br></center>
<b>echoEL.bat NET SHARE </b><br> &nbsp; &nbsp; - будет выполнена команда NET SHARE (выдать список разделяемых сетевых ресурсов) и выдан код ERRORLEVEL<br> 
<b>echoEL.bat NET SHARE X"="C:\</b> <br> &nbsp; &nbsp; - будет выполнена команда NET SHARE X:=C:\ (создать разделяемый сетевой ресурс с именем X, и путем в корневой каталог 
диска C:) Обратите внимание на то, что символ = заключен в двойные кавычки. <br>
&nbsp; &nbsp; Перечисленные выше варианты задают корректную командную строку. Но попробуйте задать неверный параметр для NET.EXE или вообще 
несуществующую команду и вы увидите, какое значение примет ERRORLEVEL. 
И УЧТИТЕ, что командная строка реально ВЫПОЛНЯЕТСЯ и, например, вариант 
"echoEL.bat format A:" запустит форматирование дискеты в дисководе A:.
<br><br>
<h3 id="id10">
<center> 
<font color="blue"><b>
Диалог с пользователем<br><br></b></font></center><font color="blue"><b>
</b></font></h3>
&nbsp; &nbsp;
Для диалога с пользователем можно использовать команду:<br>
SET /P &lt; имя переменной &gt;=&lt; текст &gt;<br>
при выполнении которой, на экран выдается текстовое сообщение &lt; текст &gt; и ожидается 
ввод ответного текста. Пример - выполним запрос пароля и присвоим его значение 
переменной "pset":<br><br>

set /p pset="Enter password - " <br>
echo Password is - %pset%<br><br>

Недостатком данного способа является невозможность продолжения выполнения командного 
файла при отсутствии ответа пользователя, поэтому очень часто вместо set используются сторонние 
программы.  
Одна из них - <font color="red"> <b> CHOICE.COM</b></font>
<a href="http://white55.narod.ru/soft/choice.com">Скачать (1.7кб)</a>.<br>
CHOICE выдает пользователю текстовое сообщение и ожидает выбора одного из заданных 
вариантов ответа (нажатия клавиш на клавиатуре). По результатам выбора формируется 
переменная ERRORLEVEL, значение которой равно порядковому номеру выбора. По умолчанию 
вариантов выбора два - Y или N. Если ответ равен Y - то ERRORLEVEL=1, если N - то 
ERRORLEVEL=2. Можно использовать более 2-х вариантов выбора и есть возможность 
задать выбор по умолчанию, когда пользователь за определенное время не нажал 
ни одной клавиши. Формат командной строки:<br><br>
   
CHOICE [/C[:]choices] [/N] [/S] [/T[:]c,nn] [text]<br>

/C[:]choices &nbsp; - &nbsp; определяет допустимые варианты выбора. Если не задано - YN<br>
/N &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - &nbsp; не выдавать варианты выбора.<br>
/S &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - &nbsp; строчные и заглавные буквы отличаются.<br>
/T[:]c,nn  &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; - &nbsp; Выбор по умолчанию равен "c" через "nn" секунд<br>
text  &nbsp; &nbsp;&nbsp; &nbsp;  &nbsp; &nbsp; &nbsp; &nbsp; - Строка текста выводимая в качестве запроса <br><br>
Создадим командный файл, демонстрирующий использование CHOICE. 
Он будет реагировать на нажатие клавиш "1","2",3" и "0" .
При нажатии "0" выполняется завершение, а при нажатии остальных - сообщение пользователю. Если в 
течении 10 секунд ничего не нажато - завершение.<br><br>


@ECHO OFF<br>
:CHOICE<br>
CHOICE /C:1230 /T:0,10 Ваш вариант<br>
IF %ERRORLEVEL% EQU 4 GOTO EXIT<br>
echo Ваш выбор=%ERRORLEVEL%<br>
GOTO CHOICE<br>
:EXIT<br><br>
&nbsp; &nbsp; Теперь, используя CHOICE вы можете создавать командные файлы, логика работы 
которых может определяться пользователем.<br><br>

<h3 id="id100">
<center> 
<font color="blue"><b>
Задержки в командных файлах<br><br></b></font></center><font color="blue"><b>
</b></font></h3>
&nbsp; &nbsp;
Когда-то, еще в DOS, для организации ожидания в командном файле использовалась удобная 
команда SLEEP, но затем она почему-то перекочевала из стандартного установочного набора 
Windows в дополнительный Resource Kit. Можно просто скопировать его оттуда в каталог \system32 
и использовать в ваших командных файлах.<br><br>:
SLEEP N &nbsp; &nbsp; - где N - количество секунд для задержки.<br><br>
&nbsp; &nbsp; Если же Resource Kit нет под рукой, можно воспользоваться ранее рассмотренной 
командой CHOISE без вывода текста и с автоматическим формированием ответа через 
nn секунд (1-99):<br><br>
choice.com /T:y,10 /N &nbsp; &nbsp; - задержка на 10 секунд<br><br>
&nbsp; &nbsp; Более универсальный способ основан на пинговании петлевого интерфейса 
нужным количеством пакетов. Пинг для петлевого интерфейса (имя хоста - 
localhost или IP- адрес 127.0.0.1) выполняется без реальной передачи данных, т.е. 
практически мгновенно, а интервал между пингами составляет 1 секунду. Указывая 
количество пингов с помощью ключа "-n" можно получить задержку на n секунд:<br><br>
ping 127.0.0.1 -n 30 &gt; nul &nbsp; &nbsp; - даст задержку на 30 секунд<br><br>


<h3 id="id11">
<center> 
<font color="blue"><b>
Поиск компьютеров с запущенным приложением<br><br></b></font></center><font color="blue"><b>
</b></font></h3>
&nbsp; &nbsp;
Для реализации этого скрипта используются утилиты из пакета <b>PSTools</b>
<a href="http://white55.narod.ru/pstools.html" target="_blank">(краткое описание).</a> 

Создадим командный файл, выполняющий поиск в локальной сети компьютеров с выполняющейся 
программой, 
имя которой (начальная часть имени) задается в качестве параметра при запуске,
 например, <font color="blue"> game </font>. При обнаружении будет послано сообщение на компьютер 
ADMINCOMP и обнаруженное приложение будет принудительно завершено. Для поиска будем использовать утилиту Pslist.exe и анализировать ее код возврата. 
Значение переменной ERRORLEVEL равное нулю означает, что утилита обнаружила на 
удаленном компьютере процесс, удовлетворяющий условиям поиска. Имя процесса для 
поиска будем задавать в качестве параметра при запуске командного файла. Присвоим нашему командному файлу имя <b>psl.bat</b>. 
Запуск с параметром будет выглядеть следующим образом:<br>  
<b>psl.bat game</b><br>

&nbsp; &nbsp;
Для начала, нужно проверить, задан ли параметр в командной строке при запуске, и, 
если не задан, выдадим сообщение пользователю и завершим выполнение. Если же параметр задан - перейдем на метку 
" PARMOK ":<br>
<font color="blue">
@echo off<br>
if "%1" NEQ "" GOTO PARMOK <br>
ECHO Нужно задать имя процесса для поиска<br>
exit<br>
:PARMOK <br><br>
</font>
&nbsp; &nbsp;
Теперь нужно обеспечить последовательное формирование IP-адресов компьютеров для командной строки PSlist. 
Проще всего это сделать с помощью присвоения временной переменной окружения (действительной 
только на время выполнения командного файла) 
значения постоянной составляющей адреса (например - 192.168.0.) и вычисляемого 
значения младшей части (например, в диапазоне 1-254).  
Для примера будем считать, что нам необходимо просканировать компьютеры в диапазоне адресов:<br> 
192.168.0.1 &nbsp; - &nbsp; 192.168.0.30:<br> 

<font color="blue">set IPTMP=192.168.0. </font> - старшая часть адреса<br>
<font color="blue">set /A IPLAST=1</font> - младшая часть. Ключ /A означает вычисляемое числовое выражение<br>
<font color="blue">set IPFULL=%IPTMP%%IPLAST%</font> - значение полного IP-адреса.<br>
&nbsp; &nbsp;
Командная строка для PSlist будет выглядеть cледующим образом:<br>
<font color="blue">pslist \\%IPFULL% %1</font><br>
&nbsp; &nbsp;
Теперь осталось только циклически запускать PSlist, прибавляя в каждом цикле единицу к младшей части адреса, 
пока ее значение не достигнет 30 и анализировать значение ERRORLEVEL после выполнения. Для анализа результата будем 
выполнять переход командой:<br>
<font color="blue">GOTO REZULT%ERRORLEVEL%</font><br>
обеспечивающей переход на метку REZULT0 при обнаружении процесса и на REZULT1 - при его отсутствии.<br>
&nbsp; &nbsp;
Окончательное содержимое командного файла:<br><br>

@echo off<br>
if "%1" NEQ "" GOTO PARMOK<br>
ECHO Нужно задать имя процесса для поиска<br>
exit<br>
:PARMOK<br>
set IPTMP=192.168.0.<br>
rem Зададим начальное значение " хвоста " IP- адреса<br>
set /A IPLAST=1<br>
rem M0 - метка для организации цикла<br>
:M0<br>
rem Переменная IPFULL - полное значение текущего IP-адреса <br>
set IPFULL=%IPTMP%%IPLAST%<br>
rem Если " хвост "больше 30 - на выход<br>
IF %IPLAST% GTR 30 GOTO ENDJOB<br>
pslist \\%IPFULL% %1<br>
GOTO REZULT%ERRORLEVEL%<br>

:REZULT0<br>
rem Если найдено приложение- отправим сообщение на ADMINCOMP<br>
net send ADMINCOMP Запущено %1 - %IPFULL%<br>
rem И завершим приложение с помощью PSkill<br>

pskill \\%IPFULL% %1<br>
:REZULT1<br>
rem Сформируем следующий IP-адрес<br>
set /A IPLAST=%IPLAST% + 1<br>
rem Перейдем на выполнение следующего шага<br>
GOTO M0<br>
rem Завершение работы<br>
:endjob<br>
exit<br>
<br><br>
&nbsp; &nbsp;
В заключение добавлю, что для того, чтобы этот скрипт работал, PSlist.exe и PSkill.exe должны быть доступны в путях 
поиска исполняемых файлов, например в каталоге WINDOWS. Пользователь, запускающий его, должен обладать правами администратора по отношению к сканируемым компьютерам. 
И, если текущий пользователь таковым не является, то в параметры запуска утилит PSlist.exe и PSkill.exe нужно добавить ключи, задающие 
имя пользователя и пароль.<br><br>


<h3 id="id12">
<center> 
<font color="blue"><b>
Поиск компьютеров с запущенным приложением по списку<br><br></b></font></center><font color="blue"><b>
</b></font></h3>
&nbsp; &nbsp;
В предыдущем примере использовался прямой перебор IP-адресов компьютеров в 
локальной сети, что не всегда удобно, поскольку в процедуру опроса оказываются 
вовлечены и выключенные компьютеры. Решим задачу другим способом. Создадим текстовый 
файл со списком компьютеров и опросим их по этому списку.<br>
&nbsp; &nbsp; 
Список можно получить из сетевого окружения с использованием команды:<br>
<font color="blue">net.exe view  &gt; comps.txt </font><br>
После выполнения такой команды файл <b> comps.txt</b> будет содержать список 
следующего вида: <br><br> <font color="green">

Имя сервера &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;           Заметки<br>
&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &lt;  2 пустых строки &gt;<br>

-------------------------------------------------------------------------------<br>
\\AB1<br>
\\AB2<br>
\\ALEX<br>
\\BUHCOMP<br>
\\PC2<br>
\\SA<br>
\\SERVER<br>
Команда выполнена успешно.<br><br></font>
&nbsp; &nbsp; 
Обрабатывать содержимое этого текстового файла будем с помощью команды 
<font color="red">FOR</font>
с ключом <font color="blue"> /F:<br><br>
FOR /F ["ключи"] %переменная IN (имя файла) DO команда [параметры]
</font><br><br>
&nbsp; &nbsp;
Данная команда позволяет получить доступ к строкам в текстовом файле с использованием ключей:<br>

<b>skip=n</b> &nbsp; &nbsp;  &nbsp; &nbsp;  &nbsp; &nbsp;  &nbsp; &nbsp; - пропустить n строк от начала файла (в нашем случае - 4 строки)<br>
<b>eol=&lt; символ &gt;</b>&nbsp;&nbsp; - не использовать строки, начинающиеся с заданного символа. 
(в нашем случае - пропустить последнюю строку, начинающуюся с символа "К" - "Команда выполнена успешно"<br>
<b>tokens=n</b> &nbsp; &nbsp;  &nbsp; &nbsp;  &nbsp; &nbsp; - брать для обработки n-е слово в строке (в нашем случае - 1-е слово)<br><br>
Окончательный вид команды: <br><br>

FOR /F "eol=К skip=4 tokens=1 " %%I IN (comps.txt) DO (<br>
pslist.exe -u admin -p pass %%I %1<br>
IF NOT ERRORLEVEL 1 net.exe send ADMINCOMP %%i %1<br>
)<br><br>
&nbsp; &nbsp; &nbsp; &nbsp;Обратите внимание - 
в пакетных файлах для переменных команды FOR используется два знака процента (запись 
<b>%%переменная</b> вместо <b>%переменная</b>) и имена переменных 
учитывают регистр букв (<b>%i</b> отличается от <b>%I</b>).<br>
&nbsp; &nbsp; &nbsp; &nbsp;
Работать это будет следующим образом - пропускаются первые 4 строки текстового файла 
со списком компьютеров, и далее в цикле переменной I присваивается значение первого 
слова (текст от начала строки до разделителя - пробела), выполняется утилита 
PSlist.exe, для которой в качестве имени компьютера используется значение этой переменной. 
Если ERRORLEVEL менее 1 - задача с искомым именем присутствует в списке процессов и 
выполняется отправка сообщения с помощью NET SEND.<br>
&nbsp; &nbsp; &nbsp; &nbsp;
Окончательное содержимое командного файла:<br><br>

@echo off<br>
if "%1" NEQ "" GOTO PARMOK <br>
ECHO Нужно задать имя процесса для поиска<br>
exit<br>
:PARMOK <br>
REM<br>
REM Создадим текстовый файл comps.txt со списком компьютеров с помощью NET VIEW<br>
net view /DOMAIN:MyDomain &gt; comps.txt<br>
REM<br>
REM FOR /F "параметры" - использование данных из файла<br>
REM eol=К - не использовать строки, начинающиеся с "К" - "Команда выполнена успешно"<br>
REM skip=4 - пропустить первые 4 строки в файле<br>
REM tokens=1 - брать для обработки 1-е слово в строке<br>
REM <br>
FOR /F "eol=К skip=4 tokens=1 " %%i in (comps.txt) do (<br>
pslist.exe -u admin -p pass %%i %1<br>
IF NOT ERRORLEVEL 1 net.exe send %COMPUTERNAME% Компьютер - %%i процесс - %1<br>
)<br><br><br>




<h3 id="id13">
<center> 
<font color="blue"><b>
Выключение компьютеров по списку, созданному на основе сетевого окружения.<br><br></b></font></center><font color="blue"><b>
</b></font></h3>
&nbsp; &nbsp;
Предыдущий пример натолкнул меня на мысль сделать пакетный файл для быстрого 
выключения всех компьютеров в сети. Выключение производится утилитой PsShutdown.exe 
(описание в статье "Утилиты пакета PSTools"). Как и в предыдущем примере, 
сначала создается файл со списком компьютеров на основе сетевого окружения, а затем 
выполняется их поочередное выключение, при условии, что компьютер не свой (иначе он может 
выключиться до окончания выполнения командного файла). Содержимое файла:<br><br>
  
rem @echo off<br>
REM Здесь нужно задать  <br>
REM имя домена или рабочей группы для которых строится список машин для выключения<br>
set MyDomain=имя домена<br>
REM<br>
REM Создадим текстовый файл comps.txt со списком компьютеров с помощью NET VIEW<br>
net view /DOMAIN:%MyDomain% &gt; comps.txt<br>
REM<br>
REM FOR /F "параметры" - использование данных из файла<br>
REM eol=К - не использовать строки, начинающиеся с "К" - "Команда выполнена успешно"<br>
REM skip=4 - пропустить первые 4 строки в файле<br>
REM tokens=1 - брать для обработки 1-е слово в строке<br>
FOR /F "eol=К skip=4 tokens=1 " %%i in (comps.txt) do (<br>
REM Свой компьютер выключать не будем <br>
REM Если имя компьютера не равно COMPUTERNAME - выключаем<br>
IF /I %%i NEQ %COMPUTERNAME%  psshutdown -k -t 0 %%i<br>
)<br>
<br><br>

&nbsp; &nbsp;
Вам нужно только подредактировать строку:<br>
set MyDomain=<br>
указав имя домена и, при необходимости, добавить параметры -u -p для psshutdown.exe .<br>
&nbsp; &nbsp; Один из посетителей этой странички (спасибо, Danila17) подсказал мысль о том, 
что, как правило, в реальной жизни из списка выключаемых компьютеров нужно 
исключить несколько штук, для чего удобно использовать команду <font color="red">FIND</font> в 
цепочке с net.exe в скрипте формирования списка на основе сетевого окружения. Данная команда 
используется для поиска строк в текстовом файле по шаблону. Ключ /V используется для поиска строк 
не совпадающих с шаблоном. Для выключения компьютеров, исключая server1...server4 
удобно использовать такой вариант:<br><br>
net view | find "\\" | find /v "сервер1" | find /v "сервер2" | find /v "сервер3" | find /v "сервер4" &gt; comps.txt<br>
FOR /F "tokens=1 " %%i in (comps.txt) do shutdown.exe -f -s -m %%i<br>
<br><br>


<h3 id="id14">
<center> 
<font color="blue"><b>
Работа с оконными приложениями.<br><br></b></font></center><font color="blue"><b>
</b></font></h3>
&nbsp; &nbsp;
Допустим, вам нужно из одного и того же командного файла запустить notepad.exe 
и cmd.exe. Если просто вставить строки<br>
notepad.exe<br>
cmd.exe<br>
то после запуска notepad.exe выполнение командного файла приостановится и пока не 
будет завершен notepad, cmd.exe не запустится. Самый простой способ обойти эту 
проблему - использовать стандартную утилиту Windows <b><font color="red">
start.exe</font></b>. Полную справку по использованию можно получить по:<br>
start.exe /?<br>
Попробуйте создать командный файл следующего содержания:<br><br>
start /MAX notepad.exe<br>
start "This is CMD.EXE" /MIN cmd.exe<br>
net send %COMPUTERNAME% NOTEPAD and CMD running.<br><br>
После выполнения этого командного файла вы увидите стартовавшие, в развернутом окне 
(ключ /MAX) блокнот, в свернутом окне (ключ /MIN) командный процессор CMD.EXE и 
окно с сообщением net.exe. Стандартный заголовок окна cmd.exe заменен на текст 
"This is CMD.EXE". Обратите внимание на то что заголовок окна можно опускать, но 
особенность обработки входных параметров утилитой start.exe может привести к 
неожиданным результатам при попытке запуска программы, имя или путь которой содержит 
пробел(ы). Например при попытке выполнить следующую команду:<br>
start "C:\Program Files\FAR\FAR.EXE"<br>
Из-за наличия пробела в пути к исполняемому файлу, 
строка для запуска FAR.EXE должна быть заключена в двойные 
кавычки, однако формат входных параметров для start.exe предполагает наличие заголовка 
окна, также заключаемого в двойные кавычки, в результате чего "C:\Program Files\FAR\FAR.EXE" 
интерпретируется не как исполняемая программа, а как заголовок окна. 
Для того, чтобы подобного не случилось нужно 
использовать любой, пусть даже пустой, заголовок:<br>
start "" "C:\Program Files\FAR\FAR.EXE"<br><br><br>
&nbsp; &nbsp;

Если вам все же потребуется расширенное управление окнами приложений, 
придется воспользоваться сторонним программным обеспечением, например, 
 
<a target="_blank" href="http://white55.narod.ru/soft/cmdow.zip"><b>CMDOW</b> Скачать ~15кб</a><br>
<a target="_blank" href="http://www.commandline.co.uk/cmdow/">Сайт разработчика</a><br>
Из-за специфического поведения эта утилита большинством антивирусов определяется 
как вирус, поэтому для нормальной работы нужно занести ее в исключения антивируса. 
<br>
Cmdow.exe - крошечная утилита, работающая в Windows NT4/2000/XP/2003 без установки. 
Позволяет получить список окон, перемещать, изменять размеры, переименовывать, 
сворачивать/разворачивать, активировать/деактивировать, закрывать, скрывать окна 
приложений и многое другое. Справку можно получить по команде:<br>
cmdow /?<br>
Используется около 30 ключей. Описание на русском языке найдете 
<a target="_blank" href="http://www.computerra.ru/gid/rtfm/system/272855/">здесь.</a>
Некоторые примеры:<br><br>
<center><b></b><li><b>Получение информации об окнах:<br><br></b></li></center>
<b>cmdow.exe</b> или <b>cmdow.exe &gt; wins.txt</b> - выдать информацию обо всех окнах на экран или в файл wins.txt<br>
<b>cmdow /T </b> - выдать информацию об окнах, отображаемых на панели 
задач рабочего стола.<br>
Информация содержит колонки:<br><br>
Handle - дескриптор окна - шестнадцатеричное число, связанное с данным окном.<br>
Lev - уровень окна. Приложение может быть многооконным с несколькими уровнями окон.<br>
Pid - идентификатор процесса, породившего окно. <br>
-Window status- - состояние окна (видимое - Vis, скрытое - Hid, активное - Act, 
свернутое - Min и т.п.<br>
Image - программа вызвавшая окно.<br>
Caption - название окна<br><br>

Манипулировать окнами можно используя название окна, или его дескриптор. Если 
название окна содержит пробелы, то оно заключается в двойные кавычки. Если имеются 
русские буквы, то должна использоваться DOS-кодировка. Символ <b>@</b> используется 
для указания текущего окна. Иногда проще использовать 
дескриптор окна, а не его название. Полезным может быть и использование команды поиска 
по строке find.exe, выполняемой в цепочке с cmdow:<br>
<b>cmdow.exe | find.exe /I "hid" &gt; wins.txt </b>- в файл wins.txt попадут только строки 
содержащие шаблон "hid" и мы получим список скрытых окон.<br>
<b> cmdow.exe | find.exe /I "MyIE" &gt; wins.txt </b> - список окон приложения MyIE<br>
<br>
<b>
</b><center><b></b><li><b> Манипулирование окнами. <br></b></li></center>

Если вы хотите, чтобы ваш командный файл выполнялся скрытно, 
добавьте в него строку:<br>
<b>cmdow @ /HID</b> - скрыть текущее окно<br>
Ниже командный файл с комментариями, демонстрирующий возможности работы cmdow:<br><br>
@ECHO OFF<br>
REM Свернуть все окна - /MA<br>
cmdow /MA<br>
REM запустить cmd.exe с заголовком окна MyCMD<br>
start "MyCMD" cmd.exe<br>
REM ждать 5 секунд<br>
call :wait5s<br>
REM<br>
:M1<br>
REM Скрыть окно MyCND <br>
cmdow MyCMD /hid<br>
call :wait5s<br>
REM Сделать видимым<br>
cmdow MyCMD /vis<br>
call :wait5s<br>
REM Переместить в верхний левый угол экрана  и развернуть окно<br>
cmdow MyCMD /MOV 0 0<br>
cmdow Mycmd /max<br>
call :wait5s<br>
REM Изменить размер на 320 х 240 и переместить вправо на 320 точек<br>
cmdow MyCMD /MOV 320 0 /SIZ 320 240<br>
call :wait5s<br>
REM Переместить окно в точку с координатами 320 x 240 и изменить размер на 350x50<br>
cmdow MYCMD /MOV 320 240 /SIZ 350 50<br>
call :wait5s<br>
REM Восстановить окно<br>
cmdow MYCMD /RES<br>
call :wait5s<br>
REM Восстановить и сделать активным окно этого командного файла<br>
cmdow @ /RES /ACT<br>
ECHO Для завершения нажмите CTRL-C (CTRL-Break)<br>
call :wait5s<br>
call :wait5s<br>
REM Зацикливание - переход к метке :M1<br>
GOTO M1<br>
REM Подпрограмма задержки на 5секунд<br>
:wait5s<br>
@ping -n 5 localhost &gt; nul<br><br>


&nbsp; &nbsp; Пример командного файла, закрывающего окна Проводника Интернет 
(IEXPLORE.EXE):<br><br>
@echo off<br>
:M1<br>
for /f "tokens=1-2,8" %%a in ('cmdow') do (<br>
if /i "%%c"=="IEXPLORE" if "%%b"=="1" cmdow %%a /END &gt; nul<br>
)<br>
goto M1<br><br>
Работает это следующим образом. Из выходных данных CMDOW берется 
первое, второе и 8-е поля. 
Первое - дескриптор окна (Handle), второе - уровень (Lev), третье - имя 
программы (Image). В цикле 
выполняется cmdow и если в ее выводе имеется строка, где имя 
программы IEXPLORE и уровень окна 1 выполняется <b>cmdow &lt;дескриптор&gt; /END</b>.
Пока этот командный файл выполняется, запустить "Проводник интернета" не 
получится. А если в начало командного файла добавить "cmdow @ /hid" - то будет 
скрыто и его окно.


<br><br>


</font><b><font color="#ff0000">
</font></b><font color="#ff0000"></font><h3 id="id20"><font color="#ff0000"><b>
<p align="CENTER">Типичные ошибки .</p>
</b></font></h3>
<font size="3">
<p>&nbsp;</p>
<p>&nbsp;</p>

</font><ul><font size="3">
</font><font size="3" color="#0000ff"><li>Командный файл вручную выполняется без проблем, но по расписанию – не работает.</li></font></ul><font size="3" color="#0000ff">

</font><font size="3"><dir>

<p>Ситуация, как правило, вызвана тем, что вы не учитываете тот факт, что на момент выполнения вашего командного файла переменные среды могут быть совсем другими, чем на момент его написания и запуска из командной строки. Например, в командном файле используется запуск  приложения myprog.exe, находящегося в каталоге SCRIPTS на диске D: . Если в командном файле используется имя модуля без полного пути</p>
<p>…</p>
<p>MYPROG.EXE </p>

<p>    и если каталог D:\SCRIPTS не прописан в путях поиска (переменная PATH )  то модуль MYPROG.EXE может быть найден и выполнен только если текущим каталогом является D:\SCRIPTS. Но если вы укажете полный путь к myprog.exe</p>
<p>…</p>
<p>D:\SCRIPTS\myprog.exe</p>
<p> </p>
<p>То программа будет найдена и выполнена в любом случае.</p>
<p>Есть еще одна тонкость - нередко программа, указанная в командном файле использует для поиска своих компонент (dll, ini и т.п. ) собственный каталог.  Но на момент ее выполнения текущим каталогом может быть любой (чаще всего – системный каталог Windows). Естественно, компоненты не находятся и программа не выполняется. Для устранения проблемы добавьте в командный файл команды, обеспечивающие переход в нужный каталог. Например, программа myprog.exe должна выполняться в каталоге D:\SCRIPTS:</p>

<p>Rem Сменим текущий диск</p>
<p>D:</p>
<p>Rem перейдем в каталог SCRIPTS</p>
<p>CD D:\SCRIPTS</p>
<p>myprog.exe</p>
<p>    Прием со сменой каталога наиболее универсален и,  как правило всегда срабатывает.</p>
</dir>


</font><ul><font size="3">
</font><font size="3" color="#0000ff"><li>Не удается использовать русские имена файлов, служб и т.п.</li></font></ul><font size="3" color="#0000ff">
</font><dir><font size="3" color="#0000ff">

</font><font size="3"></font><p><font size="3">Причина в том, что при создании командных файлов вы 
использовали текстовый редактор, в котором русские символы  представлены 
не в DOS-кодировке. Если в приведенном выше примере перезапуска службы “DNS-клиент” 
вы используете неверную кодировку, то русская часть имени службы не будет опознана 
из-за неверной кодировки и будет выдано сообщение, что указанная служба не 
установлена.  Чтобы избежать проблем с русскими символами в командных файлах, 
используйте редактор с поддержкой DOS-кодировки, например, встроенный редактор 
файлового менеджера <a target="_blank" href="http://white55.narod.ru/far.html">FAR</a>.
   
Переключение между кодировками в редакторе осуществляется нажатием <b> F8 </b>.
С помощью FAR можно легко осуществлять перекодировку, скопировав (вырезав) текст в буфер обмена, затем 
нажав F8 и вставив текст из буфера.
</font>
</p></dir>
<ul>
<font size="3" color="#0000ff"><li>Скрипт нормально работает на одном компьютере, но на другом - не срабатывает.</li></font></ul><font size="3" color="#0000ff">
</font>
<dir>
&nbsp; &nbsp; Обычно это вызвано применением в командных файлах абсолютных значений вместо 
переменных среды окружения. Вместо C:\WINDOWS правильнее использовать %SYSTEMROOT%, потому, 
что на другом компьютере система может быть установлена в другой каталог или на другой диск. 
Старайтесь вместо имени командного файла использовать переменную %0 и ее 
подстановочные 
варианты (%~d0 - диск с которого запущен сценарий, %~dp0 - полный путь и т.д.). 
<br><br>


&nbsp; &nbsp; Строки с переменными, принимающими значения имен файлов и каталогов лучше 
заключать в кавычки. Командная строка <br>
DIR %ProgramFiles% <br>
не выдаст вам содержимого каталога C:\Program Files , поскольку из-за наличия пробела будет 
интерпретирована как<br>
DIR C:\Program<br>
Командная строка<br>
DIR "%ProgramFiles%"<br>
выполнится верно.<br><br>

&nbsp; &nbsp; Старайтесь использовать команды Setlocal и Endlocal, чтобы не оставлять мусор 
из переменных, созданных или модифицированных командным файлом.<br<br> 


</br<br></dir>

<p></p>
<h3 id="id21">
<p align="center"><b>Использование командных файлов в сценариях регистрации
пользователей .</b></p></h3>
<p><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; Командные файлы
удобно использовать для выполнения каких-либо
действий при регистрации пользователя в
домене. Делается это с помощью вкладки "Profile" 
свойств пользователя домена.</font></p>
<p><img border="0" src="./Командные файлы_files/logscript.jpg" width="404" height="484"></p>
<p>&nbsp;</p>
<p>Сами командные файлы скриптов должны
находиться в сетевой папке &nbsp; Netlogon (для Win2k -
это папка WINNT \ SYSVOL \ DOMAIN \ SCRIPTS) контроллера
домена, доступ на чтение к которой должен
быть у всех пользователей, проходящих
регистрацию.</p>

<br><br>

Дополнительно к данной статье, на сайте есть:<br><br>
<a target="_blank" href="http://ab57.ru/cmdlist.html">Список команд, 
используемых в командной строке Windows</a><br><br>
<a target="_blank" href="http://ab57.ru/netcmd.html">Отдельная статья о работе с сетью в командной строке Windows</a>

<br><br><br>
<font size="+1">
<center> <a href="./Командные файлы_files/Командные файлы.htm">В начало страницы</a> | 
<a href="http://white55.narod.ru/index.html">
<font color="RED">
Что еще можно найти на этом сайте </font>
</a> </center></font>


<br><br>
<center>
<div id="DIV_DA_39248"><table cellpadding="0" cellspacing="0" width="100%" style="border-collapse: collapse;"><tbody><tr><td class="da_adp_teaser" width="33%" style="vertical-align:top; padding: 0 15px 15px 0; border: 0; text-align: left;">
   <table cellpadding="0" cellspacing="0" border="0" width="100%">
      <tbody><tr><td class="da_adp_img" style="vertical-align:top; width: 110px; padding-right: 7px;"><a href="http://code.directadvert.ru/click/?x=L8dB-GJRa1OKrBiFHdjHFry1A3UHgbDqovZRi7wfsknSek0uHdfIxuOfdvQtgjMuZ4VVPtUvhYu1VAGm8DwqfLQOmlirLwSIHPvYbNXVs948SVkjS2-5ak-W3o7iuvu6Q0msKVRQkZojHYw_Wy3_A8WF91ZNx4AXXAomNxfKmKLaLasH7wGPLCRFv9atiTcIT8wvJz1rjdaqEThrOzMmBChnnBMwkjCV_8NsSXlRXREUNZrSq-x8Xoj68HP_6s39p0cSlhahaoU" target="_blank"><img src="./Командные файлы_files/1139383.jpg" style="width:110px; height:110px; border: 0;"></a></td>
      <td class="da_adp_title" style="vertical-align:top; width: 100%; text-align:left;"><a href="http://code.directadvert.ru/click/?x=L8dB-GJRa1OKrBiFHdjHFry1A3UHgbDqovZRi7wfsknSek0uHdfIxuOfdvQtgjMuZ4VVPtUvhYu1VAGm8DwqfLQOmlirLwSIHPvYbNXVs948SVkjS2-5ak-W3o7iuvu6Q0msKVRQkZojHYw_Wy3_A8WF91ZNx4AXXAomNxfKmKLaLasH7wGPLCRFv9atiTcIT8wvJz1rjdaqEThrOzMmBChnnBMwkjCV_8NsSXlRXREUNZrSq-x8Xoj68HP_6s39p0cSlhahaoU" target="_blank" style="font-family:inherit; font-size:inherit; font-weight:normal; text-decoration:none; color: #000000;">Что на САМОМ ДЕЛЕ свалилось на Челябинск?! Ученые не смогли больше скрывать</a></td></tr>
   </tbody></table>
</td><td class="da_adp_teaser" width="33%" style="vertical-align:top; padding: 0 15px 15px 0; border: 0; text-align: left;">
   <table cellpadding="0" cellspacing="0" border="0" width="100%">
      <tbody><tr><td class="da_adp_img" style="vertical-align:top; width: 110px; padding-right: 7px;"><a href="http://code.directadvert.ru/click/?x=9ydYrdfxRpxooadmKqpwwn88b0u2pJ9VrDeGeCsxGjoyMV75u_p8DTA0FBwn50BHbzrBeictk93LxmNI1VHrMtxq-IWdvytmv3L17FQ2aDOvmup-DYjU8VX4HhfyShne5rhMBhJ3zVjS0lsQCmxCPA92e36kJjEBLxVGu5zSBbZG-axvWROF1GFVcGEm9ND39-_bZomOEI4TLi4zK6QZtecflQ3L4krkMzO0uvdY2SdLykgGPYUOz-_-wtu5s6OrO0XYMlkPv30" target="_blank"><img src="./Командные файлы_files/1139374.jpg" style="width:110px; height:110px; border: 0;"></a></td>
      <td class="da_adp_title" style="vertical-align:top; width: 100%; text-align:left;"><a href="http://code.directadvert.ru/click/?x=9ydYrdfxRpxooadmKqpwwn88b0u2pJ9VrDeGeCsxGjoyMV75u_p8DTA0FBwn50BHbzrBeictk93LxmNI1VHrMtxq-IWdvytmv3L17FQ2aDOvmup-DYjU8VX4HhfyShne5rhMBhJ3zVjS0lsQCmxCPA92e36kJjEBLxVGu5zSBbZG-axvWROF1GFVcGEm9ND39-_bZomOEI4TLi4zK6QZtecflQ3L4krkMzO0uvdY2SdLykgGPYUOz-_-wtu5s6OrO0XYMlkPv30" target="_blank" style="font-family:inherit; font-size:inherit; font-weight:normal; text-decoration:none; color: #000000;">Как развлекаются заключенные в колонии</a></td></tr>
   </tbody></table>
</td><td class="da_adp_teaser" width="33%" style="vertical-align:top; padding: 0 15px 15px 0; border: 0; text-align: left;">
   <table cellpadding="0" cellspacing="0" border="0" width="100%">
      <tbody><tr><td class="da_adp_img" style="vertical-align:top; width: 110px; padding-right: 7px;"><a href="http://code.directadvert.ru/click/?x=280Pqey8f0eZSHQPUPGfnh9ctHPWwee3xC8_sdM7PPLs-_ZXuKE8Yz2eFEbV-QdQmDGqUMmiNwLnlxOYk7VN_EWmu3m4wYSx8cW6rMRVzREcPlE93YwsY4J3XUb6GwOdqTgPFI5-9GRyRckS6WMP7OAlwHjINDtHuLQmESxZ4a2A25gjg7Y2wbGDe3jvOo7a2xzEt9gJXoPZ9KVdybTsq_dj02REpZM-XkaDNZ8W2UMf6MCdmCE-9pMr8Uw9_gxkvFOR2KyB4Fo" target="_blank"><img src="./Командные файлы_files/1139495.jpg" style="width:110px; height:110px; border: 0;"></a></td>
      <td class="da_adp_title" style="vertical-align:top; width: 100%; text-align:left;"><a href="http://code.directadvert.ru/click/?x=280Pqey8f0eZSHQPUPGfnh9ctHPWwee3xC8_sdM7PPLs-_ZXuKE8Yz2eFEbV-QdQmDGqUMmiNwLnlxOYk7VN_EWmu3m4wYSx8cW6rMRVzREcPlE93YwsY4J3XUb6GwOdqTgPFI5-9GRyRckS6WMP7OAlwHjINDtHuLQmESxZ4a2A25gjg7Y2wbGDe3jvOo7a2xzEt9gJXoPZ9KVdybTsq_dj02REpZM-XkaDNZ8W2UMf6MCdmCE-9pMr8Uw9_gxkvFOR2KyB4Fo" target="_blank" style="font-family:inherit; font-size:inherit; font-weight:normal; text-decoration:none; color: #000000;">В Челябинске упал НЕ МЕТЕОРИТ, а…</a></td></tr>
   </tbody></table>
</td></tr><tr class="da_adp_links"><td colspan="3" style="font: normal 9px Arial; line-height: 12px;">
<a href="http://www.directadvert.ru/?source=directadvert.ru&medium=adp&campaign=adp_user&ad=adp_39248" target="_blank" style="color: #ff8400; margin-right: 5px;"><strong>Direct/ADVERT</strong></a>
<a href="http://www.directadvert.ru/?source=directadvert.ru&medium=adp&campaign=adp_user&ad=adp_39248" target="_blank" style="white-space: nowrap; margin-right: 10px;">Дать объявление</a>
</td></tr>
</tbody></table></div>
</center>
<br><br>



</font></li></td>
<!-- правый отступ -->
<td width="5%">
</td>
</tr></tbody></table>


<hr><table width="90%" border="0" cellspacing="0" cellpadding="2">
 <tbody><tr align="center">


<td>
<!--Rating@Mail.ru COUNTEr--><script language="JavaScript" type="text/javascript"><!--
d=document;var a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1" type="text/javascript"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2" type="text/javascript"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3" type="text/javascript"><!--
js=13//--></script><script language="JavaScript" type="text/javascript"><!--
d.write('<a href="http://top.mail.ru/jump?from=937438"'+
' target=_top><img src="http://dd.c4.be.a0.top.list.ru/counter'+
'?id=937438;t=210;js='+js+a+';rand='+Math.random()+
'" alt="Рейтинг@Mail.ru"'+' border=0 height=31 width=88/><\/a>')
if(11<js)d.write('<'+'!-- ')//--></script><a href="http://top.mail.ru/jump?from=937438" target="_top"><img src="./Командные файлы_files/counter" alt="Рейтинг@Mail.ru" border="0" height="31" width="88/"></a><!-- <noscript><a
target=_top href="http://top.mail.ru/jump?from=937438"><img
src="http://dd.c4.be.a0.top.list.ru/counter?js=na;id=937438;t=210"
border=0 height=31 width=88
alt="Рейтинг@Mail.ru"/></a></noscript><script language="JavaScript" type="text/javascript"><!--
if(11<js)d.write('--'+'>')//--><!--/COUNTER-->
</td>




  <td>
<!-- begin of Top100 code -->
<script id="top100Counter" type="text/javascript" src="./Командные файлы_files/top100.jcn"></script><a href="http://top100.rambler.ru/home?id=554556" target="_blank"><img src="./Командные файлы_files/top100.scn" title="Rambler&#39;s Top100" alt="Rambler&#39;s Top100" border="0"></a><noscript>&lt;a href="http://top100.rambler.ru/home?id=554556" target="_blank"&gt;&lt;img src="http://cnt.rambler.ru/top100.cnt?554556" alt="Rambler's Top100" width="81" height="63" border="0" /&gt;&lt;/a&gt;</noscript>
<!-- end of Top100 code -->

</td>




<td>
<!--SpyLOG-->
<span id="spylog2015067"><a target="_blank" href="http://rating.openstat.ru/site/2015067"><img alt="SpyLOG" border="0" src="./Командные файлы_files/digits"></a></span><script type="text/javascript"> var spylog = { counter: 2015067, image: 5006, next: spylog }; document.write(unescape('%3Cscript src%3D"http' + (('https:' == document.location.protocol) ? 's' : '') + '://counter.spylog.com/cnt.js" defer="defer"%3E%3C/script%3E')); </script><script src="./Командные файлы_files/cnt.js" defer="defer"></script>
<!--SpyLOG-->

</td>
<td>
<!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='http://www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t14.11;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet: показано число просмотров за 24"+
" часа, посетителей за 24 часа и за сегодня' "+
"border='0' width='88' height='31'><\/a>")
//--></script><a href="http://www.liveinternet.ru/click" target="_blank"><img src="./Командные файлы_files/hit" alt="" title="LiveInternet: показано число просмотров за 24 часа, посетителей за 24 часа и за сегодня" border="0" width="88" height="31"></a><!--/LiveInternet-->


</td>

<td>
<a href="http://www.bagler.ru/in.php?id=kemet6" target="_blank"><img src="./Командные файлы_files/bagler_88x31.jpg" width="88" height="31" border="0" alt="Баглер - рейтинг русскоязычных сайтов"></a> 
</td>
<td>
<!-- MyCounter v.2.0 -->
<script type="text/javascript"><!--
my_id = 118999;
my_width = 88;
my_height = 31;
my_alt = "MyCounter - счётчик и статистика";
//--></script>
<script type="text/javascript" src="./Командные файлы_files/counter2.0.js">
</script><script language="JavaScript">my_j=0;</script><script language="JavaScript1.1">my_j=1;</script><script language="JavaScript1.2">my_j=2;</script><script language="JavaScript1.3">my_j=3;</script><script language="JavaScript1.4">my_j=4;</script><script language="JavaScript1.5">my_j=5;</script><script language="JavaScript1.6">my_j=6;</script><script language="JavaScript1.7">my_j=7;</script><script language="JavaScript1.8">my_j=8;</script><script language="JavaScript1.9">my_j=9;</script><script language="JavaScript"></script><a href="http://mycounter.ua/" target="_blank" onclick="this.href=my_stats_url"><img src="./Командные файлы_files/counter.php" width="88" height="31" title="MyCounter - счётчик и статистика" alt="MyCounter - счётчик и статистика" border="0"></a><noscript>
&lt;a target="_blank" href="http://mycounter.ua/"&gt;&lt;img
src="http://get.mycounter.ua/counter.php?id=118999"
title="MyCounter - счётчик и статистика"
alt="MyCounter - счётчик и статистика"
width="88" height="31" border="0" /&gt;&lt;/a&gt;</noscript>
<!--/ MyCounter -->
</td>

</tr></tbody></table>
<!-- Yandex.Metrika counter -->
<div style="display:none;"><script type="text/javascript">
(function(w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter77160 = new Ya.Metrika({id:77160,
                    clickmap:true,
                    trackLinks:true, webvisor:true,type:1});
        }
        catch(e) { }
    });
})(window, "yandex_metrika_callbacks");
</script></div>
<script src="./Командные файлы_files/watch.js" type="text/javascript" defer="defer"></script>
<noscript>&lt;div&gt;&lt;img src="//mc.yandex.ru/watch/77160?cnt-class=1" style="position:absolute; left:-9999px;" alt="" /&gt;&lt;/div&gt;</noscript>
<!-- /Yandex.Metrika counter -->
<!-- Directadvert -->
<script charset="windows-1251" type="text/javascript" src="./Командные файлы_files/show.cgi"></script><script charset="windows-1251" type="text/javascript" src="./Командные файлы_files/show(1).cgi"></script>


<div id="wrchoverdiv"><div id="wrccontainer"><div id="wrcheader"><div id="wrctitle"> WebRep</div></div><div class="wrchorizontal"></div><div id="wrccurrentvote">Общий рейтинг</div><div class="wrchorizontal"></div><div id="wrcrating"></div><div id="wrcratingtext">У этого сайта нет рейтинга</div><div id="wrcweighttext">(недостаточно голосов)</div><div id="wrcflags"><div id="wrcicon_shopping" class="wrcicon"></div><div id="wrcicon_social" class="wrcicon"></div><div id="wrcicon_news" class="wrcicon"></div><div id="wrcicon_it" class="wrcicon"></div><div id="wrcicon_corporate" class="wrcicon"></div><div id="wrcicon_pornography" class="wrcicon"></div><div id="wrcicon_violence" class="wrcicon"></div><div id="wrcicon_gambling" class="wrcicon"></div><div id="wrcicon_drugs" class="wrcicon"></div><div id="wrcicon_illegal" class="wrcicon"></div></div><div class="wrchorizontal"></div></div></div></body><span id="skype_highlighting_settings" display="none" autoextractnumbers="1" hightlightingswitched="0"></span><object id="skype_plugin_object" location.href="http://white55.narod.ru/cmd.html" location.hostname="white55.narod.ru" style="position: absolute; visibility: hidden; left: -100px; top: -100px;" width="0" height="0" type="application/x-vnd.skype.click2call.chrome.5.7.0"></object></html>